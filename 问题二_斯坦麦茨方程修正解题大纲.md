# 问题二：斯坦麦茨方程修正解题大纲

**核心目标：** 解决传统斯坦麦茨方程（Steinmetz Equation, SE）未考虑温度影响而导致预测不准的问题。本方案旨在：1）量化温度变化对SE模型预测精度的影响；2）构建一个包含温度因素的**修正斯坦麦茨方程（Modified Steinmetz Equation, MSE）**；3）通过数据验证修正模型的优越性。

**研究对象：** 附件一中**材料1**在**正弦波**激励下的全部实验数据。

---

### 1. 建模总体思路

本问题采用“**基准模型对比与修正**”的研究范式，通过以下步骤系统地解决问题：

1.  **数据准备：** 筛选出特定工况（材料1，正弦波）的数据，并计算必要的物理量（峰值磁通密度 $B_m$）。
2.  **建立基准模型 (SE)：** 对不含温度项的传统SE模型进行参数拟合，以此作为性能比较的基准。
3.  **分析模型局限性：** 通过分析基准模型的预测误差与温度的依赖关系，揭示其内在缺陷。
4.  **构建修正模型 (MSE)：** 提出一个将温度项融入SE模型的数学结构，形成新的、更全面的预测方程。
5.  **模型验证与比较：** 对修正模型进行拟合，并从多个维度（总体误差、分温度误差）与基准模型进行定量比较，最终证明修正的有效性。

---

### 2. 数学建模与分析步骤

#### 2.1 数据筛选与准备

- **筛选：** 从 `train_data_combined.csv` 中提取 `Material == 1` 且 `Waveform_Type == '正弦波'` 的数据子集。
- **计算峰值磁通密度 ($B_m$)：** 对每个样本的磁通密度时间序列 $B(t)$，计算其峰值：
  $$
  B_m = \frac{\max(B(t)) - \min(B(t))}{2}
  $$

#### 2.2 步骤一：建立基准模型 (SE)

- **模型方程：**
  $$
  P_v = k \cdot f^\alpha \cdot B_m^\beta
  $$
- **参数拟合：** 使用**非线性最小二乘法 (Non-Linear Least Squares)**，求解以下优化问题，以确定参数 $(k, \alpha, \beta)$：
  $$
  \min_{k, \alpha, \beta} \sum_{i=1}^{N} \left( P_{v,i}^{\text{actual}} - k \cdot f_i^\alpha \cdot B_{m,i}^\beta \right)^2
  $$

#### 2.3 步骤二：分析基准模型的局限性

- **误差计算：** 计算每个样本的**相对预测误差 (RPE)**：
  $$
  \text{RPE}_i = \frac{P_{v,i}^{\text{actual}} - \hat{P}_{v,i}^{\text{SE}}}{P_{v,i}^{\text{actual}}} \times 100\%
  $$
- **可视化分析：** 绘制**RPE与温度T的箱线图 (Box Plot)**。此图将直观展示误差分布是否随温度发生系统性偏移，从而证明SE模型在变温条件下的预测能力不足。

#### 2.4 步骤三：构建修正斯坦麦茨方程 (MSE)

- **修正假设：** 核心思想是让SE方程中的系数 $k$ 成为温度 $T$ 的函数，以捕捉温度对材料特性的影响。我们选用二次多项式来表征这种非线性关系：
  $$
  k(T) = c_0 + c_1 T + c_2 T^2
  $$
- **修正模型方程 (MSE)：** 将 $k(T)$ 代入原方程，得到包含温度项的修正模型：
  $$
  P_v = (c_0 + c_1 T + c_2 T^2) \cdot f^\alpha \cdot B_m^\beta
  $$
  此模型共有五个待拟合参数：$(c_0, c_1, c_2, \alpha, \beta)$。

#### 2.5 步骤四：模型验证与效果比较

1.  **MSE模型拟合：** 再次使用非线性最小二乘法，对MSE模型的五个参数进行拟合。

2.  **定量比较：** 通过以下指标，全面评估SE模型和MSE模型的预测效果：
    - **总体性能指标：** 在**全部**筛选数据上，计算并比较两个模型的：
        - **均方根误差 (RMSE):** $\sqrt{\frac{1}{N}\sum(P^{\text{actual}} - P^{\text{predicted}})^2}$
        - **平均绝对百分比误差 (MAPE):** $\frac{100\%}{N}\sum \left| \frac{P^{\text{actual}} - P^{\text{predicted}}}{P^{\text{actual}}} \right|$
        - **决定系数 ($R^2$)**
    - **分温度性能指标：** 分别在25℃, 50℃, 70℃, 90℃四个温度等级下，计算并比较两个模型的MAPE。

- **结论：** 通过比较上述指标，预期结果将显示MSE模型相比于SE模型，具有更低的总体误差（更低的RMSE和MAPE，更高的$R^2$），并且在各个温度点下的误差更加均衡、稳定。这将有力地证明我们构造的修正方程在预测磁芯损耗方面效果更好。