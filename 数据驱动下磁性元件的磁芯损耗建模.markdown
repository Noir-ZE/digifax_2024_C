# 2024年中国研究生数学建模竞赛C题

# 数据驱动下磁性元件的磁芯损耗建模

## 一、背景

随着国民经济发展和社会进步，基于电力电子技术的电能变换（电能变换是指将电能从一种形式转变成另一种形式，如直流电转换为不同电压的直流电，直流电转换为不同频率和大小的交流电等）得到迅速发展，尤其是新能源和信息通讯领域。电能变换技术在通讯电源、算力电源、数据中心电源、新能源功率变换、轨道交通、电动汽车、电气传动、智能电网、绿色照明等各个方面都有广泛应用。随着第三代功率半导体技术的发展，高频、高功率密度和高可靠性成为功率变换器产品的发展方向。磁性元件（变压器、电感等）作为功率变换器中必不可少的器件，担负着磁能的传递、存储、滤波等功能，对功率变换器的体积、重量、损耗、成本等都具有重要的影响。为了获得高效率和高功率密度的设计，除了满足磁性元件电气参数的可行性设计外，还要求其损耗小。因此，必须详细研究和分析磁性元件的损耗特性，磁性元件的损耗包括绕组损耗和磁芯损耗。铜导体的绕组损耗可以通过电磁场有限元仿真技术准确获得，但磁芯损耗是磁性材料在高频交变磁通作用下产生的功率损耗（本题中损耗都是指功率损耗），由于高频磁性材料（如铁氧体、合金磁粉芯、非晶/纳米晶等）本身的微观结构复杂，且其损耗与工作频率、磁通密度、励磁波形、工作温度、磁芯材料等诸多因素有关，并呈现复杂的非线性和相互关联性。现有的磁芯材料损耗模型与实际应用的需求有较大差异。

![电能变换技术的应用](./media/image1.png)

![功率变换器中的磁性元件](./media/image2.png)

目前，磁芯损耗模型主要分为两大类：损耗分离模型和经验计算模型。

### 1. 磁芯损耗分离模型

磁芯损耗可分成3个部分：磁滞损耗、涡流损耗和剩余损耗[1]。这种计算磁芯损耗的方法称为损耗分离模型，这种模型试图通过分别计算这些成分的损耗来得到总损耗。其计算公式如下：

\[
P_v = P_h + P_e + P_r
\]

其中：\(P_v\) 为总的磁芯损耗密度（也称为单位体积磁芯损耗，简称为磁芯损耗，经常简记为：\(P_v\)）；\(P_h\) 为磁滞损耗；\(P_e\) 为涡流损耗；\(P_r\) 为剩余损耗。

### 2. 磁芯损耗经验计算模型

经验计算模型则是一种更简便的方法，它基于实验数据或理论推导得出的经验公式来估算磁芯损耗。

斯坦麦茨方程（Steinmetz-equation(SE)[2]）是最著名的经验计算模型之一。在正弦波励磁（励磁是指电流通过磁件的线圈产生磁场）下，磁芯损耗计算公式如下：

\[
P_v = k f^\alpha B_m^\beta
\]

其中：\(P_v\) 为磁芯损耗；\(f\) 是频率；\(B_m\) 是磁通密度的峰值；\(k, \alpha, \beta\) 是根据实验数据拟合的系数，一般 \(\alpha \in [1, 2], \beta \in [2, 3]\)。公式表明了单位体积的磁芯损耗（磁芯损耗密度）取决于频率和磁通密度峰值的幂函数。SE方程仅适用于正弦波励磁，并且不同的磁芯材料和工况（工况指的是磁性材料所处的不同工作环境，包括温度、频率、励磁波形等），其系数未必相同（更详细内容请参阅参考文献后备注1）。

由上述可以看出，磁芯损耗与温度、材料、频率、磁通密度的峰值有关系。但影响磁芯损耗的因素较多，现阶段，鲜有普遍适用并且精度高的模型，这使得业内在使用磁性元件时无法对磁芯损耗做出精确的评估，进而影响到对功率变换器效率的评估。因此，希望基于数据驱动，建立一个高精度并且普遍适用于各种工况的磁芯损耗模型成为亟待解决的问题（参考文献后有备注1：磁芯损耗模型的相关知识，及备注2：人工智能软件辅助答题规范，请注意参阅）。

## 二、问题描述

为解决磁性元件磁芯材料损耗精确计算问题，通过实测磁性元件在给定工况（不同温度、频率、磁通密度）下磁芯材料损耗的数据，通过数学建模（或算法）方法，建立功率磁性元件的磁芯材料损耗模型，并且将其预测磁性元件在其他工况中的磁芯损耗，检测模型精确度。

### 1. 实验场景和采集数据

磁芯损耗的测量目前一般采用交流功率法，如图3所示，被测磁芯一般采用圆环形（\(l_e\) 是平均磁路长度；\(A_e\) 是磁芯截面积），在磁芯上均匀绕制励磁绕组和感应绕组（\(N_1\) 和 \(N_2\) 分别是励磁绕组和感应绕组的匝数，一般取 \(N_1 = N_2\)），信号发生器产生给定频率（周期）的正弦波或者其他波形，经过高频功率放大器高频作为励磁源施加到励磁绕组上，根据安培环路定律，绕组励磁电流在磁芯上产生磁场强度（磁场强度是指单位电流元在磁场中所受到的洛伦兹力，是描述磁场强弱的重要参数），磁场强度作用于导磁材料磁芯上产生磁通密度（磁通密度是指单位面积垂直于磁力线的磁通量，即单位面积上垂直于磁场方向的磁通量），根据电磁感应定律，磁芯中交变的磁通则在感应绕组上产生感应电压 \(u(t)\)，进一步通过采集被测磁芯绕组的励磁电流，从而得到磁场强度和磁通密度，利用式(3)计算出励磁源的输出功率（单位体积），即磁芯损耗密度。

\[
P_v = \frac{1}{T} \int_0^T H(t) \cdot \frac{dB(t)}{dt} dt
\]

![双绕组法测量磁芯损耗](./media/image3.png)

由式(3)也可知：一个励磁周期内的单位体积磁芯损耗就等于 B-H 磁滞回线的面积，如图4所示。

![B-H磁滞回线](./media/image4.png)

### 2. 数据说明

（1）解压附件（数据）.rar，附件一为训练集，有4个数据表，分别表示来自4种不同磁芯材料所测的数据（由于磁芯材料的复杂性，我们仅用材料1、材料2、材料3、材料4来表示不同材料），4个数据表结构相同，其中：

- 第1列是温度，取4个值：25、50、70、90，单位：摄氏度（℃）；
- 第2列是频率，取值范围：50000—500000，单位：赫兹（Hz）；
- 第3列是磁芯损耗，单位：每立方米瓦特（W/m³）；
- 第4列是励磁波形类型：正弦波、三角波和梯形波；
- 第5—1029列是磁通密度，共1024个采样点（一个周期时间内，相同间距采样），单位：特斯拉（T）；

每一行表示磁芯在一种工况下的实验结果，不同行表示不同的工况。

（2）附件二、附件三均为测试集，其中附件二：

- 第1列是样本序号；第2列是温度；第3列是频率；第4列是磁芯材料：材料1、材料2、材料3、材料4；第5—1029列是磁通密度（与附件一中相应的结构、格式、含义相同）。

附件三：第1列是样本序号；其他除磁芯损耗改为磁芯材料外，与附件一中相应的结构、格式、含义相同。

## 三、完成如下问题

### 问题一 励磁波形分类

励磁波形作为影响磁芯性能的核心要素之一，其形态深刻影响着磁芯的损耗特性。励磁波形的独特形状直接塑造了磁芯内部磁通的动态行为，不同的波形轮廓影响了磁通密度随时间的变化速率，导致其损耗特性呈现出显著差异。因此，准确识别出励磁波形，对于深入理解磁芯损耗机制、优化磁芯设计具有至关重要的价值。

励磁波形主要体现在磁通密度随时间变化的分布规律上，不同的励磁波形会导致磁通密度呈现出不同的增长、衰减或波动模式。请利用附件一中磁通密度数据，首先分析磁通密度的分布特征及不同波形的形状特征，提取出反映磁通密度分布及波形的形状特征变量；然后利用这些特征变量建立分类模型，识别出励磁的三种波形，分析分类模型的合理性及有效性；并对附件二中的样本识别出相应波形，把分类结果填入附件四（Excel表格）中第2列，要求：（1）按样本序号填入相应分类结果，只填数字，1表示正弦波，2表示三角波，3表示梯形波，比如：附件二中第1个样品分类结果是三角波，在第2列样本序号为1对应行就填数字2；（2）结果填入附件四后，保留原文件名，以附件材料上传；（3）统计出附件二中三种波形的各自数量，呈现在论文正文中；（4）特别把附件二中样本序号为：1、5、15、25、35、45、55、65、75、80的分类结果，以表格形式呈现在论文正文中。

### 问题二 斯坦麦茨方程（Steinmetz-equation）修正

在传统磁芯损耗模型中，斯坦麦茨方程（Steinmetz-equation）（公式（2））虽作为经典模型被广泛应用，却显著受限於其特定的适用条件，如：该方程主要针对正弦波形设计；对于不同种类的磁芯材料及工作温度的变化，SE方程会造成较大的误差，这在实际工程应用中带来了诸多不便与复杂性。目前已经有针对非正弦波形下磁芯损耗模型进行修正（见公式（7）、（8））。

请通过分析斯坦麦茨方程（公式（2）），在同一种磁芯材料、正弦波形下，对于不同温度变化，磁芯损耗预测效果存在的差异性，构造一种可适用于不同温度变化的磁芯损耗修正方程（即在原斯坦麦茨方程基础上，增加温度这个因素，以适应不同温度变化，使磁芯损耗预测效果更好）；并以附件一材料1中正弦波形的数据为例，分析你构造的修正方程与斯坦麦茨方程，他们预测磁芯损耗的效果（误差）哪个更好？

### 问题三 磁芯损耗因素分析

在磁性元件的设计与优化领域，磁芯损耗是一个核心指标，其大小直接关系到设备的效率与稳定性。在众多影响磁芯损耗的因素中，温度、励磁波形以及磁芯材料被公认为是最常见且比较重要的三大要素。为了精准提升磁性元件的性能，我们亟需依托实验数据，深入剖析这三者如何独立或协同作用于磁芯损耗，并探索实现最低损耗的最优条件。

请根据附件一中的实验数据，通过数据分析技术，分析温度、励磁波形和磁芯材料这三个因素，是如何独立及协同影响着磁芯损耗（仅讨论两两之间协同影响）；以及他们各自的影响程度；并给出这三个因素在什么条件下，磁芯损耗可能达到最小？

### 问题四 基于数据驱动的磁芯损耗预测模型

在磁芯损耗的研究领域中，尽管存在着众多传统模型（如文首“背景”所述），这些模型各自在不同的条件下展现了一定的应用价值，但普遍面临精度不足或适用范围受限的挑战。当前，业界缺乏一个既广泛适用又能提供高精度预测结果的磁芯损耗模型，这直接制约了磁性元件设计中对损耗的精确评估，进而影响了整体功率变换器效率的有效预估。鉴于这一现状，业界对构建更为便捷、精准的数据驱动模型寄予了厚望，旨在开发出一个能够跨越不同材料类型与工况条件的磁芯损耗预测模型。这样的模型将极大提升磁性元件设计的精确性与效率，为电力电子技术的进一步发展奠定坚实基础。

请利用附件一中的实验数据，通过数据分析与建模技术，构建磁芯损耗预测模型，分析模型的预测精度、泛化能力，以及对业界的各种指导意义；同时对附件三中样本的磁芯损耗进行预测，把预测结果填入附件四（Excel表格）中第3列，要求：（1）按样本序号填入相应的磁芯损耗预测结果，只保留小数点后1位；（2）结果填入附件四后，保留原文件名，（与问题一的结果一起）以附件材料上传；（3）特别把附件三中样本序号为：16、76、98、126、168、230、271、338、348、379的磁芯损耗预测结果，以表格形式呈现在论文正文中。

### 问题五 磁性元件的最优化条件

在磁性元件的设计与优化领域内，磁芯损耗固然是一个不容忽视的核心评价指标，但在工程实践中，为了实现磁性元件整体性能的卓越与最优化，需要综合考虑多个评价指标，其中，传输磁能就是重要的评价指标之一，因此，同时考虑磁芯损耗与传输磁能这二个评价指标，对于指导磁性元件的设计方向、优化其性能表现，具有重要的理论及实践意义。

请以问题四构建的磁芯损耗预测模型为目标函数，同时考虑传输磁能这个重要指标（由于传输磁能概念的复杂性，我们仅以频率与磁通密度峰值的乘积来衡量传输磁能大小），利用附件一中的实验数据，建立优化模型，分析在什么条件下（温度、频率、波形、磁通密度峰值及磁芯材料），能达到最小的磁芯损耗以及具有最大的传输磁能（即达到最大）？

## 参考文献

[1] G. Bertotti. General properties of power losses in soft ferromagnetic materials. IEEE Transactions On Magnetics, 1988: 621-630.

[2] C. P. Steinmetz. On the law of hysteresis. AIEE Transactions, vol. 9, 1892: 3–64.

[3] Rudy Severns. HF core loss for non-sinsoidal waveforms. Proc. HFPC’91,1991: 140-148.

[4] Venkatachalam K, Sullivan C R, Abdallah T, et al. Accurate prediction of ferrite core loss with nonsinusoidal waveforms using only Steinmetz parameters[C]// IEEE Workshop on Computers in Power Electronics. Mayaguez, Puerto Rico, USA, 2002: 36-41.

[5] 叶建盈，陈为，汪晶慧. PWM波及直流偏磁励磁下磁芯损耗模型研究[J]. 中国电机工程学报, 2015, 35(10): 2601-2606.

## 备注1：磁芯损耗模型的相关知识

以下更详细介绍二类磁芯损耗模型的相关知识

### 1. 磁芯损耗分离模型

基于磁芯损耗的物理机制，将总损耗分解为三个独立的成分（见公式（1））。

#### （1）磁滞损耗

在磁化过程中，磁芯材料内部的磁畴展现出不同的响应机制。其中，一部分磁畴与外加磁场方向相近，它们通过一种类似“弹性”的灵活转动来顺应磁场变化，这种顺应在撤除外加磁场后，使得磁畴仍能维持其被磁化的方向。而另一部分磁畴则需要跨越较大的障碍，克服磁畴壁之间的摩擦力，实现一种更为“刚性”的转动，当外加磁场消失时，这些经历“刚性”转动的磁畴同样维持其磁化方向不变。因此，磁化过程中输入给磁场的能量被划分为两大类别：第一类能量，如同蓄水池中的势能，当磁化电流被切断时，能够回流至电路中；而第二类能量，则转化为克服磁畴间摩擦所消耗的热能，称为磁滞损耗，其结果是磁芯材料因发热而散失能量。特别地，单位体积内产生的磁滞损耗量，直接与静态磁滞回线所围成的面积成正比，这是一个重要的量化指标。在低频工作环境下，磁滞损耗相较于其他两种损耗（如涡流损耗和剩余损耗）显得尤为显著，占据主导地位，对系统的整体性能产生重要影响。磁滞损耗计算如下：

\[
P_h = k_h f B_m^\beta
\]

其中：\(f\) 是频率；\(B_m\) 是磁通密度的峰值（最大值）；\(k_h\) 和 \(\beta\) 是通过实验数据拟合出的系数。

#### （2）涡流损耗

磁芯材料虽然具备较高的电阻率，但并非理想中的无穷大值。因此，当磁通交变时，会在磁芯中产生感应电压，进而产生电流（通常称为涡流）会在磁芯内部循环，导致能量的耗散，称为涡流损耗。计算如下：

\[
P_e = k_e f^2 B_m^2
\]

其中：\(f\) 是频率；\(B_m\) 是磁通密度的峰值；\(k_e\) 则与被测磁芯的截面积与电阻率有关。

#### （3）剩余损耗

除了磁滞损耗和涡流损耗以外的损耗统称为剩余损耗，剩余损耗取决于材料的固有akash特性之中，具体包括：磁畴壁及其相互间角度的动态形成与变化；磁畴壁运动过程中的非正弦性、不均匀性以及这种运动模式的难以重复再现；磁通密度表现出的非正弦波形及其在空间上的局部波动；材料内部粒子间复杂而微妙的相互作用力；以及磁畴壁在特定条件下发生的成核与消失等微观现象。剩余损耗的计算如下：

\[
P_r = k_r \sigma A_e B_m^{1.5}
\]

其中：\(\sigma\) 是电导率；\(A_e\) 是磁性元件的有效截面积；\(k_r\) 是一个常数 0.1356；\(k_r\) 是需拟合的系数。

### 2. 磁芯损耗经验计算模型

常见经验计算模型有以下三种。

#### （1）斯坦麦茨方程（Steinmetz-equation）

见公式（2）。

#### （2）修正的斯坦麦茨方程

电力电子功率变换器中，磁性元件的工作励磁绝大部分为非正弦波。对于非正弦波励磁下的磁芯损耗，仅依靠 SE 方程来计算会造成较大的误差。文献[3] 在斯坦麦茨方程的基础上，不增加额外的参数，提出了修正的斯坦麦茨方程（Modified Steinmetz-Equation，MSE）来计算任意波形励磁下的磁芯损耗。MSE 假设磁芯损耗与磁通密度变化率有关的物理性质，再通过对不同时刻的磁通密度变化率作加权处理，得到加权平均磁密变化率，并认为磁芯损耗由加权平均磁密变化率决定。从而计算出任意波形励磁下的等效正弦波频率：

\[
f_{eq} = \frac{2}{\pi^2} \cdot \frac{1}{T} \int_0^T \left( \frac{dB(t)}{dt} \right)^2 dt
\]

而后用等效正弦波频率计算非正弦波励磁下磁芯损耗：

\[
P_v = k f_{eq}^\alpha B_m^\beta
\]

其中：\(f\) 是非正弦波频率；\(k, \alpha, \beta\) 是等效频率下斯坦麦茨方程的系数，与公式（2）的系数获取方法一致。

#### （3）IGSE (Improved Generalized Steinmetz equation)

针对任意波形励磁下磁芯损耗的计算，文献[4] 提出了 iGSE 模型，认为磁芯损耗与磁通密度变化率以及磁通密度在一个周期内的峰峰值均存在相关性，如式(9)、(10)所示：

\[
P_v = \frac{1}{T} \int_0^T k_i \left| \frac{dB(t)}{dt} \right|^\alpha |B(t)|^{\beta - \alpha} dt
\]

\[
k_i = \frac{k}{(2\pi)^{\alpha - 1} \int_0^{2\pi} |\cos \theta|^\alpha 2^{\beta - \alpha} d\theta}
\]

其中：\(B_{pp}\) 是磁通密度在一个周期内的峰峰值（即一个周期内最大值与最小值的差值）；\(k, \alpha, \beta\) 是等效频率下斯坦麦茨方程的系数。

## 备注2：人工智能软件辅助答题规范

以大模型为代表的人工智能软件（诸如 ChatGPT、Perplexity、文心一言、通义千问等）已经在人们的生产生活不同方面崭露头角。如果你在回答上述问题时采用了人工智能软件，请遵循以下原则：

1. 把人工智能软件作为答题的辅助工具，而非主导手段。人工智能软件可以在信息搜集、开拓思路、和工具学习等方面助一臂之力，但是不可以替代你们的独立思考。
2. 对人工智能软件的输出应当先理解，再利用。最终呈现在解答中的内容，应当是你们自己的语言。如果在查重检测中发现你们论文使用人工智能软件与其他参赛队的输出内容雷同，将被判为违规，并按竞赛规定受到处罚。
3. 在使用人工智能软件辅助论文写作中，正文和数学模型及公式引用出处应是正式发表的文献或输入论文所提供的网址可在网上查询到的内容，而非引用人工智能软件得到的内容或结果。
4. 披露对人工智能软件的使用情况。答题过程中，如果使用了人工智能技术，请在正文最后以附录形式披露所采用的人工智能软件、提供的输入、及对输出的后续处理策略，内容包括但不限于算法组合采用的开发框架、开源软件、算法逻辑中的技术路线、假设条件、参数与超参数等。