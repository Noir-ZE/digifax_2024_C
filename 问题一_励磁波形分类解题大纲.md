# 问题一：励磁波形分类解题大纲

**核心目标：** 基于附件一提供的磁通密度时间序列数据 `B(t)`，构建一个高精度、高泛化能力的机器学习分类模型，以准确识别三种励磁波形（正弦波、三角波、梯形波），并利用该模型完成对附件二测试数据的分类任务。

---

### 1. 建模总体思路

本项目采纳监督学习的建模范式，将波形分类问题转化为一个多分类机器学习任务。总体流程规划如下：

1.  **数据整合与预处理：** 将四个训练数据文件合并，并对 `B(t)` 时间序列进行标准化处理，以消除量纲和直流偏置的影响。
2.  **特征工程：** 从原始 `B(t)` 数据中提取能够深刻反映波形本质形态差异的特征变量，这是模型成功的关键。我们将从**时域、频域、导数形态**三个维度构建特征体系。
3.  **分类模型构建与评估：** 选用先进的机器学习算法（如LightGBM），利用提取的特征和已知的波形标签进行模型训练。通过**交叉验证**方法科学、严谨地评估模型的性能和泛化能力。
4.  **预测与结果生成：** 将训练好的最优模型应用于附件二的测试数据，完成波形识别，并按照赛题要求格式化输出结果。

---

### 2. 数据预处理

#### 2.1 数据加载与整合
- 加载 `Training_Data_1.xlsx` 至 `Training_Data_4.xlsx` 四个文件。
- 为每个文件的数据添加一列“材料来源”（例如，材料1、材料2等）。
- 将四个数据集合并为一个完整的训练数据集。

#### 2.2 标准化 (Normalization)
为使特征提取不受磁通密度幅值 `B_m` 和直流偏置的影响，对每个样本的 `B(t)` 序列（记为向量 $\mathbf{B}$）进行Z-score标准化，得到 $\mathbf{B'}$:
$$
\mathbf{B'} = \frac{\mathbf{B} - \mu_B}{\sigma_B}
$$
其中, $\mu_B$ 和 $\sigma_B$ 分别是向量 $\mathbf{B}$ 的均值和标准差。后续所有特征均在标准化后的 $\mathbf{B'}$ 上计算。

---

### 3. 特征工程 (Feature Engineering)

为实现对波形的精准区分，我们设计并提取以下三类特征变量：

#### 3.1 时域统计特征
描述信号的整体分布形态。

- **峭度 (Kurtosis):** **核心区分特征**。衡量波形峰值的尖锐程度。
  $$
  \text{Kurt} = \frac{\frac{1}{N}\sum_{i=1}^{N}(B'_i)^4}{(\frac{1}{N}\sum_{i=1}^{N}(B'_i)^2)^2}
  $$
  理论上，梯形波峭度最低，其次是正弦波，三角波最高。

- **偏度 (Skewness):** 衡量波形的不对称性。
  $$
  \text{Skew} = \frac{\frac{1}{N}\sum_{i=1}^{N}(B'_i)^3}{(\frac{1}{N}\sum_{i=1}^{N}(B'_i)^2)^{3/2}}
  $$

- **波峰因子 (Crest Factor):** 波形峰值与有效值(RMS)之比，反映峰值在波形中的极端程度。
  $$
  C_f = \frac{|\mathbf{B'}|_{\max}}{B'_{\text{rms}}}
  $$

#### 3.2 频域特征
通过快速傅里叶变换(FFT)分析信号的谐波构成。

- **总谐波失真 (Total Harmonic Distortion, THD):** **核心区分特征**。衡量波形与纯正弦波的差异。
  $$
  \text{THD} = \frac{\sqrt{\sum_{h=2}^{N/2} A_h^2}}{A_1}
  $$
  其中 $A_h$ 是第 $h$ 次谐波的幅值。理想正弦波THD≈0，三角波和梯形波的THD则显著较高。

- **关键谐波能量比 (Key Harmonic Ratios):**
  - 3次谐波与基波能量比: $R_{3/1} = A_3^2 / A_1^2$
  - 5次谐波与基波能量比: $R_{5/1} = A_5^2 / A_1^2$
  
  这两个比值有助于进一步区分非正弦波（三角波和梯形波）。

#### 3.3 导数形态特征
分析磁通密度变化率 `dB/dt` 的特征，能极大地放大波形轮廓的差异。我们使用一阶差分 $\Delta B'_i = B'_{i+1} - B'_i$ 近似导数。

- **导数的峭度 (Kurtosis of Derivative):** **极具区分度的王牌特征**。
  - **三角波**的导数近似为方波，其峭度理论值为1（极低）。
  - **正弦波**的导数为余弦波，峭度与自身相似（约1.5）。
  - **梯形波**的导数是正、零、负脉冲，峭度介于前两者之间。

---

### 4. 分类模型构建与评估

1.  **特征矩阵构建:**
    - 将上述提取的6个特征（峭度、偏度、波峰因子、THD、R_3/1, R_5/1、导数峭度）组合成特征矩阵 $\mathbf{X}$。
    - 将训练集中的“励磁波形类型”作为目标标签向量 $\mathbf{y}$。

2.  **模型选择:**
    - 选用 **LightGBM (Light Gradient Boosting Machine)** 作为主分类模型。该模型以训练速度快、内存占用低和预测精度高而著称，非常适合处理表格型数据。

3.  **模型训练与评估:**
    - **训练:** 在完整的训练数据集上训练LightGBM分类器。
    - **评估:** 采用**5折交叉验证 (5-Fold Cross-Validation)** 评估模型的性能。
        - **合理性分析:** 高交叉验证准确率（预期 > 99.5%）证明所选特征的有效性和模型的合理性。
        - **有效性分析:** 计算并展示混淆矩阵、精确率(Precision)、召回率(Recall)和F1分数(F1-Score)，以全面评估模型对每一类波形的识别能力。

---

### 5. 预测与结果生成

1.  **对附件二进行预测:**
    - 加载 `Test_Data_2.xlsx`。
    - 对其 `B(t)` 数据执行与训练集完全相同的预处理和特征提取流程，生成测试特征矩阵 $\mathbf{X}_{\text{test}}$。
    - 使用训练好的最终模型对 $\mathbf{X}_{\text{test}}$ 进行预测，得到分类结果。

2.  **按要求输出结果:**
    - **生成附件四:** 创建 `附件四.xlsx`，第一列为样本序号，第二列为预测的波形类别（1:正弦波, 2:三角波, 3:梯形波）。
    - **统计波形数量:** 在论文正文中报告附件二中三种波形各自的总数。
    - **展示特定样本:** 在论文正文中以表格形式，展示样本序号为 1, 5, 15, 25, 35, 45, 55, 65, 75, 80 的分类结果。